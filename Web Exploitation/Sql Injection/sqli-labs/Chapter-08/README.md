# Chapter-08

This section will deal with challenges based on cookies. 

## What are cookies?

> An HTTP cookie (also called web cookie, Internet cookie, browser cookie, or simply cookie) is a small piece of data sent from a website and stored on the user's computer by the user's web browser while the user is browsing.

Wikipedia has an awesome [post](https://en.wikipedia.org/wiki/HTTP_cookie) on cookies.

## Exploiting cookies : lesson-20 and lesson-21

Lesson-20 is a simple challenge where the cookie value changes depending on who logs in to the website. 

This makes the cookie vulnerable. 

The cookie can be exploited by setting the below mentioned value - 

```sql 
' union select group_concat(username), group_concat(password), 3 from users #
```

:warning: The query breaks when ```\``` is set as a value to the cookie. 

Lesson-21 is exactly similar to lesson-21 with the only difference being that in lesson-21, the cookie value is base64 encoded. Therefore, to exploit the cookie, the payload will also have to be base64 encoded which will look somewhat like this - 

```
JykgdW5pb24gc2VsZWN0IGdyb3VwX2NvbmNhdCh1c2VybmFtZSksIGdyb3VwX2NvbmNhdChwYXNzd29yZCksIDMgZnJvbSB1c2VycyAj
```

## Lesson 22

This challenge is quite similar to challenge 21. 

Here the information present in the cookie is directly fed to the sql query without sanitizing the input. 

The input fields however are well protected. The inputs of the input fields are sanitized before feeding it to the sql query. 

The cookie is set after the user logs-in. The information shown after the user logs-in is taken from the cookie. 

The username is stored in the cookie after the user logs-in. Then the username stored in the cookie is used to display the information on the webpage. Since, the username is used directly without performing any checks, we can exploit the cookie value to perform a sql injection. 

The cookie value is ```base64``` encoded which can be easily decoded. 

The payload is shown below -

```sql
-admin" union select group_concat(id), group_concat(username), group_concat(password) from users limit 0, 1 #
```

The above payload now needs to be ```base64``` encoded and set in the cookie value.

## Lesson 23



## Second Order injections

